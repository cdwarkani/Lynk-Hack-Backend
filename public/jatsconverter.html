<!DOCTYPE html>
<html>
<style>
    html,
    body {
        height: 100%;
        margin: 0;
        padding: 0;
    }

    .container-fluid,
    .row {
        height: 1000px
    }

    .board-container {
        padding: 40px;
        box-sizing: border-box
    }

    .board {
        background-color: #fff;
        height: 100%;
        padding: 40px;
    }

    .arrow {
        box-sizing: border-box;
        height: 5vw;
        width: 5vw;
        border-style: solid;
        border-color: #5CB85C;
        border-width: 0px 13px 13px 0px;
        transform: rotate(45deg);
        transition: border-width 150ms ease-in-out;
    }

    .arrow:hover {
        border-bottom-width: 4px;
        border-right-width: 4px;
    }
</style>


<style type="text/css">
    /* START of Reference Section CSS*/

    table {
        margin: 0 auto;
        width: 100%;
        clear: both;
        border-collapse: collapse;
        table-layout: fixed;
        word-wrap: break-word;
    }

    .jrnlRefHead {
        font-size: 26px;
        color: #134985;
        /*font-weight:bold;*/
        text-align: left;
        /*border-bottom:2pt solid #134985;*/
    }

    .jrnlRefSubHead {
        font-size: 24px !important;
        color: #134985 !important;
        text-align: left;
        font-weight: bold;
    }

    p {
        cursor: pointer;
    }

    p:hover {
        border-bottom: 1px solid;
        border-top: 1px solid;
    }

    .selectedRef {
        background-color: rgba(255, 218, 41, 0.23);
        border-bottom: 1px solid #FFD700;
        border-top: 1px solid #FFD700;
        cursor: pointer;
    }

    .jrnlRefText {
        color: red;
        font-size: 16px !important;
        font-weight: bolder !important;
        line-height: 175% !important;
        padding-left: 20px;
    }

    .jrnlRefText {
        color: black !important;
        font-size: 14px !important;
        font-weight: normal !important;
        line-height: 175% !important;
        padding-bottom: 5px;
    }

    .jrnlRefAnnotation,
    .jrnlRefAnnotation {
        color: #5757FF !important;
        font-size: 12px !important;
        line-height: 150% !important;
        padding: 0 20px 10px 20px;
    }

    .RefTextError,
    .RefTextError,
    .RefTextError {
        background-color: red;
        color: black !important;
    }

    /*
 .noPMID {
    border: 1pt solid red;
    paddding: 5px !important;
}
*/

    .book {
        color: #F5F5DC;
    }

    .conf-proc {
        color: #00FFFF;
    }

    .journal {
        color: #98FB98;
    }

    .other {
        color: #FFC0CB;
    }

    .patent {
        color: #87CEFA;
    }

    .web {
        color: #DDA0DD;
    }

    .RefArticleTitle,
    .RefArticleTitle,
    .RefArticleTitle {
        color: #F99500;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefAuthor,
    .RefAuthor,
    .RefAuthor {
        border: 1pt solid #285C5B !important;
        color: #388E8E;
        font-size: 14px !important;
        font-weight: normal !important;
        padding: 0 5px;
    }

    .RefAuthor,
    .RefAuthor {
        display: inline-block;
    }

    .RefBookTitle,
    .RefBookTitle,
    .RefBookTitle {
        border-bottom: 1pt solid #000000;
        color: #065658;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefTransTitle,
    .RefTransTitle,
    .RefTransTitle {
        border-top: 1pt solid #000000;
        border-bottom: 1pt solid #000000;
        color: #0A8E92;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefBookSeries,
    .RefBookSeries,
    .RefBookSeries {
        border-bottom: 1pt solid #0000FF;
        border-top: 1pt solid #0000FF;
        color: #FFD700;
        font-size: 14px !important;
    }

    .RefChapterTitle,
    .RefChapterTitle,
    .RefChapterTitle {
        color: #22AD73;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefCollaboration,
    .RefCollaboration,
    .RefCollaboration {
        color: #4682B4;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefComments,
    .RefComments,
    .RefComments {
        color: #FF00FF;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefInPress,
    .RefInPress,
    .RefInPress {
        color: #B00058;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefConfDate,
    .RefConfDate,
    .RefConfDate {
        color: #808080;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefConfLoc,
    .RefConfLoc,
    .RefConfLoc {
        color: #000080;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefConfName,
    .RefConfName,
    .RefConfName,
    .RefThesis,
    .RefThesis,
    .RefThesis {
        color: #800000;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefConfSponsor,
    .RefConfSponsor,
    .RefConfSponsor {
        color: #8B4513;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefConfTitle,
    .RefConfTitle,
    .RefConfTitle {
        color: #BDB76B;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefDay,
    .RefDay,
    .RefDay {
        color: #4B0082;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefDiss,
    .RefDiss,
    .RefDiss {
        color: #8A2BE2;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefDissLoc,
    .RefDissLoc,
    .RefDissLoc {
        color: #7CFC00;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefDissUniv,
    .RefDissUniv,
    .RefDissUniv {
        color: #3CB371;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefDOI,
    .RefDOI,
    .RefDOI,
    .RefAOP {
        color: #800080;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefDOI:before {
        content: ' doi: ';
    }

    .RefEdition,
    .RefEdition,
    .RefEdition {
        color: #008080;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefEditor,
    .RefEditor,
    .RefEditor {
        border: 1pt solid #510101 !important;
        color: #801C1C;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefComment,
    .RefComment,
    .RefComment {
        color: #636465;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefEtal,
    .RefEtal,
    .RefEtal {
        color: #D2691E;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefFPage,
    .RefFPage,
    .RefFPage {
        color: #FF6347;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefGivename,
    .RefGivenname,
    .RefGivenname,
    .RefGivenName,
    .RefGivenName {
        color: orange;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefISBN,
    .RefISBN,
    .RefISBN {
        color: #00FF00;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefIssue,
    .RefIssue,
    .RefIssue {
        color: rgba(211, 6, 210, 0.68);
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefJournalTitle,
    .RefJournalTitle,
    .RefJournalTitle {
        color: #808000;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefLAD,
    .RefLAD,
    .RefLAD {
        color: #556B2F;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefLPage,
    .RefLPage,
    .RefLPage {
        color: #008000;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefMonth,
    .RefMonth,
    .RefMonth {
        color: #2F4F4F;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefPublisherLoc,
    .RefPublisherLoc,
    .RefPublisherLoc {
        color: #CD853F;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefPublisherName,
    .RefPublisherName,
    .RefPublisherName {
        color: #FF1493;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefSlNo,
    .RefSlNo,
    .RefSlNo {
        color: #D55B6F;
        font-size: 14px !important;
        font-weight: normal !important;
        /*float: left;
    margin-left: -20px;*/
    }

    .RefSuffix,
    .RefSuffix,
    .RefSuffix {
        color: #8B5F65;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefSurname,
    .RefSurname,
    .RefSurname,
    .RefSurName,
    .RefSurName {
        color: #3852B0;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefVolume,
    .RefVolume,
    .RefVolume {
        color: #8B008B;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefWebSite,
    .RefWebSite,
    .RefWebSite {
        color: #0000FF;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefPatent,
    .RefPatent,
    .RefPatent {
        color: #CD326C;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefYear,
    .RefYear,
    .RefYear {
        color: #DC143C;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    .RefUrl,
    .RefUrl,
    .RefUrl {
        color: blue;
        font-size: 14px !important;
        font-weight: normal !important;
    }

    p {
        color: #FF0000;
        font-size: 14px;
        line-height: 250% !important;
        text-align: justify;
    }

    .RefArticleTitle,
    .RefAuthor,
    .RefBookTitle,
    .RefChapterTitle,
    .RefCollaboration,
    .RefComments,
    .RefConfDate,
    .RefConfLoc,
    .RefConfName,
    .RefConfSponsor,
    .RefConfTitle,
    .RefDay,
    .RefDiss,
    .RefDissLoc,
    .RefDissUniv,
    .RefDOI,
    .RefAOP,
    .RefEdition,
    .RefEditor,
    .RefEtal,
    .RefFPage,
    .RefGivenName,
    .RefISBN,
    .RefIssue,
    .RefJournalTitle,
    .RefLAD,
    .RefLPage,
    .RefMonth,
    .RefPublisherLoc,
    .RefPublisherName,
    .RefSlNo,
    .RefSuffix,
    .RefSurName,
    .RefVolume,
    .RefWebSite,
    .RefYear,
    .RefUrl {
        /*font-size: 12px !important;*/
    }

    /* END of Reference Section CSS*/
</style>

<style>
    /* Markup */

    body {}



    .content {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);

        p {
            margin: 0 0 20px;
        }

    }

    /* Arrow & Hover Animation */

    #more-arrows {
        width: 75px;
        height: 65px;

        &:hover {

            polygon {
                fill: #000;
                transition: all .2s ease-out;

                &.arrow-bottom {
                    transform: translateY(-18px);
                }

                &.arrow-top {
                    transform: translateY(18px);
                }

            }

        }

    }

    polygon {
        fill: #000;
        transition: all .2s ease-out;

        &.arrow-middle {
            opacity: 0.75;
        }

        &.arrow-top {
            opacity: 0.5
        }

    }

    td.details-control {
        background: url('https://drive.google.com/uc?id=1SN5WXMMl7pieG0eAUqmzpJUJXBG96fUA') no-repeat center center;
        cursor: pointer;
    }

    tr.shown td.details-control {
        background: url('https://drive.google.com/uc?id=1_Q-RzMR6xTw_-qPTKiaaduYuFnyK86h5') no-repeat center center;
    }
</style>
<style>
    .fileContainer {
        overflow: hidden;
        position: relative;
    }

    .fileContainer [type=file] {
        cursor: inherit;
        display: block;
        font-size: 999px;
        filter: alpha(opacity=0);
        min-height: 100%;
        min-width: 100%;
        opacity: 0;
        position: absolute;
        right: 0;
        text-align: right;
        top: 0;
    }

    /* Example stylistic flourishes */

    .fileContainer {
        background: #fff;
        border-radius: .5em;
        float: left;
        padding: .4em;
        border: 1px solid #ccc
    }

    .fileContainer:hover {
        background: #ccc;
        border-radius: .5em;
        float: left;
        padding: .4em;
        border: 1px solid gray
    }

    .fileContainer [type=file] {
        cursor: pointer;
    }
</style>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.css" rel="stylesheet" />
<!-- DataTables library file -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.3.1/css/buttons.dataTables.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css">
<script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.3.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.flash.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.print.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>


<body>
    <style>
        body {
            font-family: sans-serif;
            color: #666;
        }

        #holder {
            width: 860px;
            margin: 25px auto;
        }



        .icon {
            float: left;
            width: 14px;
            height: 14px;
            position: relative;
            display: block;
            color: #666;
        }

        .icon:before,
        .icon:after {
            position: absolute;
            content: "";
            display: block;
        }

        .icon-search,
        .icon-file:before,
        .icon-flag,
        .icon-tag,
        .icon-link,
        .icon-chevron-left,
        .icon-chevron-right,
        .icon-chevron-up,
        .icon-chevron-down,
        .icon-heart:before,
        .icon-heart:after,
        .icon-left:after,
        .icon-right:before,
        .icon-up:after,
        .icon-down:before {
            -webkit-transform: rotate(-45deg);
            -moz-transform: rotate(-45deg);
            -ms-transform: rotate(-45deg);
            -o-transform: rotate(-45deg);
            transform: rotate(-45deg);
        }

        .icon-comment:after,
        .icon-wrench,
        .icon-heart:after,
        .icon-forbidden:after,
        .icon-left:before,
        .icon-right:after,
        .icon-up:before,
        .icon-down:after {
            -webkit-transform: rotate(45deg);
            -moz-transform: rotate(45deg);
            -ms-transform: rotate(45deg);
            -o-transform: rotate(45deg);
            transform: rotate(45deg);
        }

        /* Gear */

        .icon-gear:before {
            width: 20px;
            height: 20px;
            box-shadow: 0 0 0 4px inset;
            border-radius: 20px;
            border: 1px dashed;
            top: -1px;
            left: -1px;
        }
    </style>
    <script>

        var fileName = 'tags.json';

    </script>
    <div class="container-fluid">
        <div class="row board-container">
            <!-- <a href="#" class="btn" style="float: right;width: 40px;height: 40px;"><span class="icon icon-gear"></span></a>-->
            <div style="text-align: center;font-size: 19px;margin-bottom: 43px;" class="board">
                <div style="margin-bottom : 23px">
                    Exeter Premedia Services - JATS Converter
                </div>

                <div style="margin-top: 43px" class="col-xs-12">
                    <b>Please select the type of service.</b>
                </div>
                <div class="col-xs-12">

                    <div class="col-xs-2" style="margin-top: 43px">
                    </div>
                    <div class="col-xs-2" style="margin-top: 43px" onclick="openDoiBox()">
                    </div>
                 
                    <div class="col-xs-3" style="margin-top: 43px" onclick="openTBox()">
                        <button type="button" class="btn btn-default" style="font-size: 15px;padding: 10px">Jats to XML,JSON converter</br>
                        </button>
                    </div>
                    <div class="col-xs-3" style="margin-top: 43px" onclick="openEBox()">
                    </div>
                </div>

                <div class="col-xs-12" style="margin-top: 43px; padding: 40px;margin-bottom: 43px;display:none" id="pmidbox">
                    <div class="col-xs-12" style="font-size: 20px">
                        <b>
                            <font color="green">PMID SEARCH</font>
                        </b>
                    </div>
                    <form class="form-horizontal" id="forrm" style="margin-top :50px">

                        <div class="form-group">
                            <label class="control-label col-sm-4" for="pwd">ENTER PMID/ PMCID</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="pmiddata" placeholder="Enter PMID EX:1121211" value="2396716">
                            </div>

                        </div>

                        <div class="form-group">

                        </div>
                        <div class="form-group">

                        </div>
                        <div class="form-group">
                            <div class=" col-sm-12">
                                <button type="button" class="btn btn-success" style="width :400px;text-align: center" onclick="GenerateOutput('pmid');">Submit</button>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="col-xs-12" style="margin-top: 43px; padding: 40px;margin-bottom: 43px;display:none" id="doibox">
                    <div class="col-xs-12" style="font-size: 20px">
                        <b>
                            <font color="green">DOI SEARCH</font>
                        </b>
                    </div>
                    <form class="form-horizontal" style="margin-top :50px">

                        <div class="form-group">
                            <label class="control-label col-sm-4" for="pwd">ENTER DOI:</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="doidata" placeholder="Enter password" value="10.1126/science.169.3946.635">
                            </div>

                        </div>

                        <div class="form-group">

                        </div>
                        <div class="form-group">

                        </div>
                        <div class="form-group">

                        </div>
                        <div class="form-group">
                            <div class=" col-sm-12">
                                <button type="button" class="btn btn-success" style="width :400px;text-align: center" onclick="GenerateOutput('doi');">Submit</button>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="col-xs-12" style="margin-top: 43px; padding: 40px;margin-bottom: 43px;display:none" id="htmlbox">
                    <div class="col-xs-12" style="font-size: 20px">
                        <b>
                            <font color="green" style="margin-left:150px">TRAINING </font>
                        </b>

                        <button style="float:right;font-size: 15px;visibility: hidden" class="hide"onclick="setsamplehtmlinput();" id="sampleInput">USE SAMPLE INPUT</button>
                    </div>
                    <div class="col-xs-12" style="margin-top: 50px;margin-bottom: 50px">
                        <div class="col-xs-12">
                            <div class="col-xs-6">
                                <button type="button" class="btn btn-default" onclick="downloadDatas('default','defaultDataset.xml')" style="width: 100%">DOWNLOAD DEFAULT DATA SET</br>
                                </button>
                            </div>
                            <div class="col-xs-6">
                                <button type="button" class="btn btn-default" onclick="downloadDatas('present','presentDataset.xml')" style="width: 100%">DOWNLOAD PRESENT DATA SET</br>
                                </button>
                            </div>
                        </div>
                        <div class="col-xs-12" style="margin-top: 100px;margin-bottom:100px">
                            <div class="col-xs-12">
                                <label class="fileContainer" style="width:100%;text-align: center;height: 45px;color:#000;font-weight: normal;font-size: 17px">
                                    UPLOAD NEW DATASET FOR TRAINING
                                    <input type="file" accept="text/xml" id="fileInputsinfo4" onchange="openFile4(this,'json');" />
                            </div>
                            <div class="col-xs-12" style="margin-top: 100px">
                                <div class="col-xs-6">
                                    <button type="button" class="btn btn-default" onclick="checkStatus()" style="width: 100%">CHECK STATUS</br>
                                    </button>

                                </div>
                                <div class="col-xs-6" id="checkstatus">

                                </div>
                            </div>
                            <script>
                                var openFile4 = function (event) {
                                    var input = event.target;
                                    var reader = new FileReader();
                                    reader.onload = function () {
                                        var text = reader.result;
                                        uploadData(text);
                                    };

                                    reader.readAsText(document.getElementById("fileInputsinfo4").files[0]);
                                };
                                document.getElementById("checkstatus").innerHTML = "-";
                                function checkStatus() {
                                    toastr.success('Checking..', 'SUCCESS');
                                    $.ajax({
                                        url: '/api/check',
                                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                                        type: "POST",
                                        data: { "type": "train", "information": "traindata" },
                                        success: function (val) {
                                            toastr.clear()
                                            toastr.options = {
                                                "closeButton": false,
                                                "timeOut": "15000"
                                            }

                                            document.getElementById("checkstatus").innerHTML = val;

                                        },
                                        error: function (val) {
                                            toastr.clear()
                                            toastr.options = {};
                                            toastr.error('Failed to check.', 'FAILED', { timeOut: 5000 })
                                        }
                                    });
                                }
                            </script>
                        </div>
                    </div>
                    <form class="form-horizontal" style="margin-top :50px">

                        <div class="form-group">

                            <div class="col-xs-12" style="display: none">
                                <div class="col-sm-12">
                                    <textarea style="border-style: dashed;text-align: center;border-width: thick;" type="text" rows="7" class="form-control"
                                        id="htmldata" placeholder="ENTER TAGGED HTML INPUT" value="&lt;p class=&quot;jrnlRefText&quot; id=&quot;R1&quot; data-id=&quot;R1&quot; data-styled=&quot;RefText&quot; data-class-name=&quot;RefText&quot; data-reftype=&quot;journal&quot; data-valid-id=&quot;R1&quot; data-pmid=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20943636&quot; data-doi=&quot;10.1093/annonc/mdq276&quot; data-validated=&quot;true&quot; data-editable=&quot;false&quot;&gt; &lt;span class=&quot;RefSlNo&quot; id=&quot;ddd716da-d6da-4224-8ef5-c36c9f238cbe&quot;&gt;1.&lt;/span&gt; &lt;span class=&quot;RefAuthor&quot; id=&quot;17c59be7-dd2b-4e5e-bc17-8a3ad98e44a1&quot;&gt; &lt;span class=&quot;RefSurName&quot; id=&quot;ce432a0e-b3c8-48be-a708-bde2201b680b&quot;&gt;Ritter&lt;/span&gt; &lt;span class=&quot;RefGivenName&quot; id=&quot;306620b3-8093-4fe8-a91b-8f80f206ff02&quot;&gt;J&lt;/span&gt; &lt;/span&gt; , &lt;span class=&quot;RefAuthor&quot; id=&quot;a0075c54-8b97-45b7-911c-d6152dae3fec&quot;&gt; &lt;span class=&quot;RefSurName&quot; id=&quot;b9e19d00-fcca-44bc-937f-4e5ae25467b3&quot;&gt;Bielack&lt;/span&gt; &lt;span class=&quot;RefGivenName&quot; id=&quot;5c5e3ccb-d050-4cc1-933f-59324a2ea38b&quot;&gt;SS&lt;/span&gt; &lt;/span&gt; . &lt;span class=&quot;RefArticleTitle&quot; id=&quot;8ca0ef94-5f26-47b0-92ef-f8586cfb11c2&quot;&gt;Osteosarcoma&lt;/span&gt; . &lt;span class=&quot;RefJournalTitle&quot; id=&quot;76e4bae2-b1bd-49ba-87c8-f092211a990a&quot;&gt; &lt;em id=&quot;1b026af4-82e1-42c3-8b0e-f839cb1cf1ea&quot;&gt;Ann Oncol&lt;/em&gt; &lt;/span&gt; . &lt;span class=&quot;RefYear&quot; id=&quot;6125cdf8-4d5a-4cb3-80c1-502d04d65ead&quot;&gt;2010&lt;/span&gt; ; &lt;span class=&quot;RefVolume&quot; id=&quot;7471793b-de7b-46b1-ad79-1f236b3ea11c&quot;&gt;21 Suppl 7&lt;/span&gt; ( &lt;span class=&quot;RefIssue&quot; id=&quot;88a5846d-0bca-45df-a210-af69ebe3ed3c&quot;&gt;Suppl 7&lt;/span&gt; ): &lt;span class=&quot;RefFPage&quot; id=&quot;085a3db5-feee-4edf-8aa8-625ce8e942d7&quot;&gt;vii320&lt;/span&gt; &ndash; &lt;span class=&quot;RefLPage&quot; id=&quot;5a4f7b19-c0ef-4856-b112-fd8edd5e69ad&quot;&gt;vii325&lt;/span&gt; . &lt;/p&gt;"></textarea>
                                </div>
                            </div>

                        </div>


                        <div class="form-group">

                        </div>

                    </form>
                </div>

                <div class="col-xs-12" style="margin-top: 43px; padding: 40px;margin-bottom: 43px;display:none;border: thin solid rgb(0, 0, 0);"
                    id="referencebox">
                    <script>




                        function handleSingle() {
                            document.getElementById("referenceBoxInput").style.display = "block";
                            document.getElementById("referenceBoxInputFile").style.display = "none";
                            document.getElementById("sampleInputbut").style.visibility = 'visible';
                            document.getElementById("htmldataFile").style.display = "none";
                            document.getElementById("htmldataFiletext").style.display = "none";

                        }
                        function handleFileMode() {
                            document.getElementById('fileInputsinfo').style.display = "block";
                            document.getElementById("referenceBoxInput").style.display = "none";
                            document.getElementById("sampleInputbut").style.visibility = 'hidden';

                            document.getElementById("referenceBoxInputFile").style.display = "block";
                            document.getElementById("htmldataFile").style.display = "none";
                            document.getElementById("htmldataFiletext").style.display = "none";
                            document.getElementById("fileInputsinfo").value = "";
                        }
                    </script>
                    <div class="col-xs-12" style="margin-bottom: 50px">
                        <div class="col-xs-6 hide">
                            <input type="radio" name="colors" id="singleMode" onchange="handleSingle();" checked> &nbsp;&nbsp;&nbsp; Run using visual interface mode
                            <br>
                        </div>
                        <div class="col-xs-6 hide" >
                            <input type="radio" name="colors" id="FileMode" onchange="handleFileMode();"> &nbsp;&nbsp;&nbsp; Run using file mode
                        </div>
                    </div>
                    <div class="col-xs-12" style="font-size: 20px">
                        <b>
                            <font color="green" style="margin-left:150px">Please enter JASS input</font>
                        </b>
                        <button style="float:right;font-size: 15px" onclick="setsamplerefinput();" class="" id="sampleInputbut">USE SAMPLE INPUT</button>
                    </div>

                    <form class="form-horizontal" style="margin-top :100px">
                        <div class="form-group">
                            <div class="col-xs-12">
                                <div class="col-sm-12" id="referenceBoxInput" style="margin-top: 50px ">
                                    <textarea style="border-style: dashed;text-align: center;border-width: thick;" type="text" rows="7" class="form-control"
                                        id="refdata" placeholder="ENTER REFERENCE INPUT" value="&lt;p class=&quot;jrnlRefText&quot; id=&quot;R1&quot; data-id=&quot;R1&quot; data-styled=&quot;RefText&quot; data-class-name=&quot;RefText&quot; data-reftype=&quot;journal&quot; data-valid-id=&quot;R1&quot; data-pmid=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20943636&quot; data-doi=&quot;10.1093/annonc/mdq276&quot; data-validated=&quot;true&quot; data-editable=&quot;false&quot;&gt; &lt;span class=&quot;RefSlNo&quot; id=&quot;ddd716da-d6da-4224-8ef5-c36c9f238cbe&quot;&gt;1.&lt;/span&gt; &lt;span class=&quot;RefAuthor&quot; id=&quot;17c59be7-dd2b-4e5e-bc17-8a3ad98e44a1&quot;&gt; &lt;span class=&quot;RefSurName&quot; id=&quot;ce432a0e-b3c8-48be-a708-bde2201b680b&quot;&gt;Ritter&lt;/span&gt; &lt;span class=&quot;RefGivenName&quot; id=&quot;306620b3-8093-4fe8-a91b-8f80f206ff02&quot;&gt;J&lt;/span&gt; &lt;/span&gt; , &lt;span class=&quot;RefAuthor&quot; id=&quot;a0075c54-8b97-45b7-911c-d6152dae3fec&quot;&gt; &lt;span class=&quot;RefSurName&quot; id=&quot;b9e19d00-fcca-44bc-937f-4e5ae25467b3&quot;&gt;Bielack&lt;/span&gt; &lt;span class=&quot;RefGivenName&quot; id=&quot;5c5e3ccb-d050-4cc1-933f-59324a2ea38b&quot;&gt;SS&lt;/span&gt; &lt;/span&gt; . &lt;span class=&quot;RefArticleTitle&quot; id=&quot;8ca0ef94-5f26-47b0-92ef-f8586cfb11c2&quot;&gt;Osteosarcoma&lt;/span&gt; . &lt;span class=&quot;RefJournalTitle&quot; id=&quot;76e4bae2-b1bd-49ba-87c8-f092211a990a&quot;&gt; &lt;em id=&quot;1b026af4-82e1-42c3-8b0e-f839cb1cf1ea&quot;&gt;Ann Oncol&lt;/em&gt; &lt;/span&gt; . &lt;span class=&quot;RefYear&quot; id=&quot;6125cdf8-4d5a-4cb3-80c1-502d04d65ead&quot;&gt;2010&lt;/span&gt; ; &lt;span class=&quot;RefVolume&quot; id=&quot;7471793b-de7b-46b1-ad79-1f236b3ea11c&quot;&gt;21 Suppl 7&lt;/span&gt; ( &lt;span class=&quot;RefIssue&quot; id=&quot;88a5846d-0bca-45df-a210-af69ebe3ed3c&quot;&gt;Suppl 7&lt;/span&gt; ): &lt;span class=&quot;RefFPage&quot; id=&quot;085a3db5-feee-4edf-8aa8-625ce8e942d7&quot;&gt;vii320&lt;/span&gt; &ndash; &lt;span class=&quot;RefLPage&quot; id=&quot;5a4f7b19-c0ef-4856-b112-fd8edd5e69ad&quot;&gt;vii325&lt;/span&gt; . &lt;/p&gt;"></textarea>
                                </div>
                                <div class="col-sm-12 hide" id="referenceBoxInputFile" style="margin-top: 50px ">
                                    <input type='file' accept='text/plain' id="fileInputsinfo" onchange='openFile(event)' />
                                    <textarea style="border-style: dashed;text-align: center;border-width: thick;" type="text" rows="7" class="form-control"
                                        id="htmldataFile" placeholder="ENTER TAGGED HTML INPUT"></textarea>
                                    <textarea style="border-style: dashed;text-align: center;border-width: thick;" type="text" rows="1" class="form-control"
                                        id="htmldataFiletext" placeholder="ENTER TAGGED HTML INPUT"></textarea>

                                    <script>
                                        var openFile = function (event) {
                                            var input = event.target;
                                            var reader = new FileReader();
                                            reader.onload = function () {
                                                var text = reader.result;
                                                var node = document.getElementById('output');
                                                document.getElementById("htmldataFile").style.display = "block";
                                                document.getElementById("htmldataFiletext").style.display = "block";
                                                document.getElementById("htmldataFile").value = text;

                                                var lines = text.split(/\n/);
                                                var output = [];
                                                var outputText = [];
                                                var sOutput = "";
                                                for (var i = 0; i < lines.length; i++) {
                                                    // only push this line if it contains a non whitespace character.
                                                    if (i == 0 && (/\S/.test(lines[i]))) {
                                                        outputText.push('"' + $.trim(lines[i]) + '"');
                                                        output.push($.trim(lines[i]));
                                                        sOutput = lines[i];
                                                    } else if (/\S/.test(lines[i])) {
                                                        outputText.push('"' + $.trim(lines[i]) + '"');
                                                        output.push($.trim(lines[i]));
                                                        sOutput += "%0D" + lines[i];
                                                    }
                                                }
                                                sOutput = sOutput.substr(0, sOutput.length - 1);
                                                document.getElementById("htmldataFile").value = sOutput;
                                                document.getElementById("htmldataFiletext").value = "Loaded " + output.length + " references.";
                                            };

                                            reader.readAsText(input.files[0]);
                                        };

                                        function downloadInnerHtml(filename, elId, mimeType) {
                                            var elHtml = document.getElementById(elId).innerHTML;
                                            var link = document.createElement('a');
                                            mimeType = mimeType || 'text/plain';

                                            link.setAttribute('download', filename);
                                            link.setAttribute('href', 'data:' + mimeType + ';charset=utf-8,' + encodeURIComponent(elHtml));
                                            link.click();
                                            return false;
                                        }
                                        function downloadData(name, divid) {
                                            fileName = name;

                                            downloadInnerHtml(fileName, divid, 'text/html');
                                            return false;

                                        }
                                        
                                        function uploadData(content) {
                                            toastr.clear()
                                            toastr.options = {
                                                "closeButton": false,
                                                "timeOut": "15000"
                                            }

                                            toastr.success('Request succesfully sent. Service is training the data. Please check the status using status flag.', 'SUCCESS');

                                            $.ajax({
                                                url: '/api/anystyle',
                                                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                                                type: "POST",
                                                data: { "type": "train", "information": "traindata", "content": content },
                                                success: function (val) {
                                                    toastr.clear()
                                                    toastr.options = {
                                                        "closeButton": false,
                                                        "timeOut": "15000"
                                                    }

                                                    toastr.success('Data got trained.', 'SUCCESS');

                                                },
                                                error: function (val) {
                                                    toastr.clear()
                                                    toastr.options = {};

                                                }
                                            });
                                            return false;

                                        }
                                    </script>
                                </div>
                            </div>
                            <div class="form-group">

                            </div>
                            <div class="form-group">
                                <div class=" col-sm-12">
                                    <button type="button" class="btn btn-success" style="width :400px;text-align: center" onclick="GenerateOutput('reference')">Submit</button>
                                </div>
                            </div>
                    </form>
                    </div>



                    <div class="col-xs-12" style="margin-top: 43px; padding: 40px;margin-bottom: 43px;display:none" id="extractbox">
                        <div class="col-xs-12" style="font-size: 20px">
                            <b>
                                <font color="green"> EXTRACT SEARCH</font>
                            </b>
                        </div>
                        <form class="form-horizontal" style="margin-top :50px">
                            <div class="form-group">
                                <label class="control-label col-sm-2" for="pwd">Enter FilePathLocation:</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="extractdata" placeholder="Enter password" value="/Users/apple/BiblioServiceRefactored/_tests/ExtractedFiles/zoterofile.docx">
                                </div>
                                <div class="col-xs-10" style="margin-top: 30px ;text-align: left;font-size: 14px">[ Accepts Zotero, Mendeley, CSL Citation, Papers, RefMGR, EndNote ]</div>
                            </div>
                            <div class="form-group">

                            </div>
                            <div class="form-group">
                                <div class=" col-sm-12">
                                    <button type="button" class="btn btn-success" style="width :400px;text-align: center" onclick="GenerateOutput('extract')">Submit</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-xs-12" style="margin-top: 43px; padding: 40px;margin-bottom: 43px;" id="pmidbox2">

                <div class=" col-xs-12">
                    <div class="content">

                        <svg id="more-arrows">
                            <polygon class="arrow-top" points="37.6,27.9 1.8,1.3 3.3,0 37.6,25.3 71.9,0 73.7,1.3 " />
                            <polygon class="arrow-middle" points="37.6,45.8 0.8,18.7 4.4,16.4 37.6,41.2 71.2,16.4 74.5,18.7 " />
                            <polygon class="arrow-bottom" points="37.6,64 0,36.1 5.1,32.8 37.6,56.8 70.4,32.8 75.5,36.1 " />
                        </svg>
                    </div>
                </div>
                <form class="form-horizontal col-xs-12" style="margin-top :70px">
                    <div class="form-group">


                        <div class="col-xs-12" >
                            <div class="col-xs-6">
                                    JSON output
                                <br>
                                <div class="col-xs-12">
                                    <pre id="json" style="width: 100%;height: 400px;" contenteditable="true"></pre>
                                </div>
                                <div class="col-xs-12">
                                    <div class="col-xs-12">
                                        <button type="button" class="btn btn-default" onclick="downloadData('TaggedInputSet.json','json');" style="width: 100%">Download JSON</br>
                                        </button>
                                    </div>
                                    <div class="col-xs-4">


                                        <label class="fileContainer" style="width:100%;text-align: center;height: 35px;color:#000;font-weight: normal;display: none">
                                            Re-Upload Json
                                            <input type="file" id="fileInputsinfo2" onchange="openFile2(this,'json');" />
                                            <script>
                                                var openFile2 = function (event) {
                                                    var input = event.target;
                                                    var reader = new FileReader();
                                                    reader.onload = function () {
                                                        var text = reader.result;
                                                        document.getElementById("json").innerHTML = text;

                                                    };

                                                    reader.readAsText(document.getElementById("fileInputsinfo2").files[0]);
                                                };
                                            </script>
                                        </label>
                                    </div>
                                    <div class="col-xs-4">
                                        <button type="button" id="validfromhere" class="btn btn-default" style="width: 100%;display: none">Validate the data</br>
                                        </button>
                                        <script>
                                            document.getElementById("validfromhere").addEventListener('click', function () {
                                                toastr.options = {
                                                    "closeButton": false,
                                                    "timeOut": "500000",
                                                    "extendedTimeOut": "100000"
                                                }
                                                toastr.success('Processing, please wait..');
                                                ValidateJSON(JSON.parse(document.getElementById("json").innerHTML));
                                            });
                                        </script>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-6">
                                    xml for training
                                    <br>
                                    <div class="col-xs-12">
                                        <textarea class="pre" id="json5" style="width: 100%;height: 400px;" contenteditable="true"></textarea>
                                    </div>
                                    <div class="col-xs-12">
                                        <div class="col-xs-12">
                                            <button type="button" class="btn btn-default" onclick="downloadData('TaggedXMLSet.xml','json5');" style="width: 100%">Download XML</br>
                                            </button>
                                        </div>
                                        <div class="col-xs-4">
    
    
                                            <label class="fileContainer" style="width:100%;text-align: center;height: 35px;color:#000;font-weight: normal;display: none">
                                                Re-Upload Json
                                                <input type="file" id="fileInputsinfo2" onchange="openFile2(this,'json');" />
                                                <script>
                                                    var openFile2 = function (event) {
                                                        var input = event.target;
                                                        var reader = new FileReader();
                                                        reader.onload = function () {
                                                            var text = reader.result;
                                                            document.getElementById("json").innerHTML = text;
    
                                                        };
    
                                                        reader.readAsText(document.getElementById("fileInputsinfo2").files[0]);
                                                    };
                                                </script>
                                            </label>
                                        </div>
                                        <div class="col-xs-6">
                                            <button type="button" id="validfromhere" class="btn btn-default" style="width: 100%;display: none">Validate the data</br>
                                            </button>
                                            <script>
                                                document.getElementById("validfromhere").addEventListener('click', function () {
                                                    toastr.options = {
                                                        "closeButton": false,
                                                        "timeOut": "500000",
                                                        "extendedTimeOut": "100000"
                                                    }
                                                    toastr.success('Processing, please wait..');
                                                    ValidateJSON(JSON.parse(document.getElementById("json").innerHTML));
                                                });
                                            </script>
                                        </div>
                                    </div>
                                </div>
                           
                        </div>
                        <div class=" col-xs-12" style="margin-bottom: 80px;margin-top: 80px;display: none">
                            <div class="content">

                                <svg id="more-arrows">
                                    <polygon class="arrow-top" points="37.6,27.9 1.8,1.3 3.3,0 37.6,25.3 71.9,0 73.7,1.3 " />
                                    <polygon class="arrow-middle" points="37.6,45.8 0.8,18.7 4.4,16.4 37.6,41.2 71.2,16.4 74.5,18.7 " />
                                    <polygon class="arrow-bottom" points="37.6,64 0,36.1 5.1,32.8 37.6,56.8 70.4,32.8 75.5,36.1 " />
                                </svg>
                            </div>
                        </div>
                        <div class="col-xs-12" style="display:none;">
                            <div class="col-xs-9">
                                Validated Tagged Input set
                                <br>
                                <pre id="json3" style="width: 100%;height: 400px;" contenteditable="true"></pre>
                                <div class="col-xs-12">
                                    <div class="col-xs-12">
                                        <div class="col-xs-12" style="margin-top : 43px;margin-bottom : 43px">
                                            <div class="col-xs-12">
                                                <label for="usr">Select the style name:</label>

                                                <div class="col-xs-12">
                                                    <select name="styleid" id="styleid" style="width:80%" multiple>
                                                        <option value="" disabled selected>Loading..</option>
                                                    </select>
                                                </div>
                                                <div class="col-xs-12" id="stylesName">

                                                </div>
                                                <script>
                                                    $('select').on('change', function () {
                                                        var el = document.getElementsByTagName('select')[0];
                                                        document.getElementById("stylesName").innerHTML = getSelectValues(el);
                                                    });
                                                    function getSelectValues(select) {
                                                        var result = [];
                                                        var options = select && select.options;
                                                        var opt;

                                                        for (var i = 0, iLen = options.length; i < iLen; i++) {
                                                            opt = options[i];

                                                            if (opt.selected) {
                                                                result.push(opt.value || opt.text);
                                                            }
                                                        }
                                                        return result;
                                                    }
                                                </script>

                                            </div>


                                            <div class="col-xs-3 hidden">
                                                <label for="usr">Enter Locale:</label>
                                                <input type="text" class="form-control" id="localeid" value="locales-en-US.xml">
                                            </div>
                                            <div class="col-xs-3 hidden">
                                                <label for="usr">Enter pre string:</label>
                                                <input type="text" class="form-control" id="preid">
                                            </div>
                                            <div class="col-xs-3 hidden">
                                                <label for="usr">Enter post string:</label>
                                                <input type="text" class="form-control" id="postid">
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-xs-12">
                                        <button type="button" class="btn btn-default" onclick="downloadData('ValidatedTaggedInputSet.json','json3');" style="width: 100%">Download JSON</br>
                                        </button>
                                    </div>
                                    <div class="col-xs-4">
                                        <label class="fileContainer" style="width:100%;text-align: center;height: 35px;color:#000;font-weight: normal;display: none">
                                            Re-Upload Json
                                            <input type="file" id="fileInputsinfo3" onchange="openFile3(this,'json');" />
                                            <script>
                                                var openFile3 = function (event) {
                                                    var input = event.target;
                                                    var reader = new FileReader();
                                                    reader.onload = function () {
                                                        var text = reader.result;
                                                        document.getElementById("json3").innerHTML = text;

                                                    };

                                                    reader.readAsText(document.getElementById("fileInputsinfo3").files[0]);
                                                };
                                            </script>
                                    </div>
                                    <div class="col-xs-4">
                                        <button type="button" id="gemneratefromhere" class="btn btn-default" style="width: 100%">Generate from here</br>
                                        </button>
                                        <script>
                                            document.getElementById("gemneratefromhere").addEventListener('click', function () {
                                                toastr.options = {
                                                    "closeButton": false,
                                                    "timeOut": "500000",
                                                    "extendedTimeOut": "100000"
                                                }
                                                toastr.success('Processing, please wait..');
                                                GenerateOutputref(JSON.parse(document.getElementById("json3").innerHTML), document.getElementById("stylesName").innerHTML, 20);
                                            });</script>
                                    </div>
                                </div>
                            </div>
                            <font style="margin-left: 24px; ">Reports:</font>
                            <br>
                            <div class="col-xs-3">
                                <pre id="json4" style="width: 100%;height: 400px;"></pre>
                                <button type="button" class="btn btn-default" onclick="downloadData('ValidatedTaggedInputSetReport.json','json4');" style="width: 100%">Download Reports</br>
                                </button>

                            </div>
                        </div>
                        <div class=" col-xs-12" style="margin-top:100px ;margin-bottom:100px;display: none ">
                            <div class="content">

                                <svg id="more-arrows">
                                    <polygon class="arrow-top" points="37.6,27.9 1.8,1.3 3.3,0 37.6,25.3 71.9,0 73.7,1.3 " />
                                    <polygon class="arrow-middle" points="37.6,45.8 0.8,18.7 4.4,16.4 37.6,41.2 71.2,16.4 74.5,18.7 " />
                                    <polygon class="arrow-bottom" points="37.6,64 0,36.1 5.1,32.8 37.6,56.8 70.4,32.8 75.5,36.1 " />
                                </svg>
                            </div>
                        </div>
                        <script>
                            document.getElementById("json").innerHTML = JSON.stringify({ "Data": "No data to display" }, undefined, 2);
                            document.getElementById("json3").innerHTML = JSON.stringify({ "Data": "No data to display" }, undefined, 2);
                        </script>

                        <div class="col-xs-12" style="margin-top: 43px; ;margin-bottom: 43px;;padding-bottom: 30px;" id="dataatab">
                            <div class="col-xs-12" style="font-size: 20px;padding: 20px">
                                <b>OUTPUT</b>
                            </div>


                        </div>
                        <div class="col-xs-12" style="margin-top: 43px; ;margin-bottom: 43px;;padding-bottom: 30px;display: none" id="dataatabpmidanddoi">
                            <div class="col-xs-12" style="font-size: 20px;padding: 20px">
                                <b>OUTPUT</b>
                                <button type="button" class="btn btn-default" style="float:right;font-size: 12px;padding: 10px" onclick="downloadData('OutputData.html','finalOutputDatas');">DOWNLOAD DATA</button>
                            </div>


                            <div class="container-fluid" style="margin-bottom: 40px;">
                                <div class="col-xs-12" id="finalOutputDatas" style="border-color: black;border :solid 1px;padding: 10px; ">

                                </div>

                            </div>


                        </div>



                        <div class="col-xs-12" style="margin-top: 43px; ;margin-bottom: 43px;padding-bottom: 30px;" id="dataatabExtract">
                            <div class="col-xs-12" style="font-size: 20px;padding: 20px">
                                <b>OUTPUT</b>
                            </div>


                            <div class="container-fluid" style="margin-bottom: 40px;" id="">
                                <div class="col-xs-12" style="border-color: ;border :solid 1px;padding: 10px; ">

                                    <table id="user_data2" class="display" width="100%" cellspacing="0">
                                        <thead style="font-size: 20px;">
                                            <tr style="font-size: 20px;">

                                                <th style="font-size: 17px; width: 14%">converted JSON</th>
                                                <th style="font-size: 17px;width: 14%">Citation Data</th>
                                                <th style="font-size: 17px;width: 14%">Generated BiblioGraphy String</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>


                                </div>

                            </div>


                        </div>
                    </div>
                </form>
            </div>
        </div>



        <!-- Trigger the modal with a button -->

        <!-- Modal -->
        <div id="myModal" class="modal fade" role="dialog" style="text-align: center;width: 100%;height: 100%">
            <div class="modal-dialog" style="text-align: center;width: 100%;height: 100%">

                <!-- Modal content-->
                <div class="modal-content" style="text-align: center;width: 100%;height: 100%;opacity: 0.9">

                    <div class="modal-body" style="text-align: center;">
                        <div class="lds-css ng-scope">
                            <div class="lds-spinner" style="height: 50px;width: 50px;opacity: 1;margin-left: 40%;margin-top: 10%">
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                            </div>
                            <div class="col-xs-12">
                                <font color="green">Please, wait. Fetching data from the source..</font>
                            </div>
                            <style type="text/css">
                                @keyframes lds-spinner {
                                    0% {
                                        opacity: 1;
                                    }
                                    100% {
                                        opacity: 0;
                                    }
                                }

                                @-webkit-keyframes lds-spinner {
                                    0% {
                                        opacity: 1;
                                    }
                                    100% {
                                        opacity: 0;
                                    }
                                }

                                .lds-spinner {
                                    position: relative;
                                }

                                .lds-spinner div {
                                    left: 94px;
                                    top: 48px;
                                    position: absolute;
                                    -webkit-animation: lds-spinner linear 1s infinite;
                                    animation: lds-spinner linear 1s infinite;
                                    background: #4ae222;
                                    width: 12px;
                                    height: 24px;
                                    border-radius: 40%;
                                    -webkit-transform-origin: 6px 52px;
                                    transform-origin: 6px 52px;
                                }

                                .lds-spinner div:nth-child(1) {
                                    -webkit-transform: rotate(0deg);
                                    transform: rotate(0deg);
                                    -webkit-animation-delay: -0.916666666666667s;
                                    animation-delay: -0.916666666666667s;
                                }

                                .lds-spinner div:nth-child(2) {
                                    -webkit-transform: rotate(30deg);
                                    transform: rotate(30deg);
                                    -webkit-animation-delay: -0.833333333333333s;
                                    animation-delay: -0.833333333333333s;
                                }

                                .lds-spinner div:nth-child(3) {
                                    -webkit-transform: rotate(60deg);
                                    transform: rotate(60deg);
                                    -webkit-animation-delay: -0.75s;
                                    animation-delay: -0.75s;
                                }

                                .lds-spinner div:nth-child(4) {
                                    -webkit-transform: rotate(90deg);
                                    transform: rotate(90deg);
                                    -webkit-animation-delay: -0.666666666666667s;
                                    animation-delay: -0.666666666666667s;
                                }

                                .lds-spinner div:nth-child(5) {
                                    -webkit-transform: rotate(120deg);
                                    transform: rotate(120deg);
                                    -webkit-animation-delay: -0.583333333333333s;
                                    animation-delay: -0.583333333333333s;
                                }

                                .lds-spinner div:nth-child(6) {
                                    -webkit-transform: rotate(150deg);
                                    transform: rotate(150deg);
                                    -webkit-animation-delay: -0.5s;
                                    animation-delay: -0.5s;
                                }

                                .lds-spinner div:nth-child(7) {
                                    -webkit-transform: rotate(180deg);
                                    transform: rotate(180deg);
                                    -webkit-animation-delay: -0.416666666666667s;
                                    animation-delay: -0.416666666666667s;
                                }

                                .lds-spinner div:nth-child(8) {
                                    -webkit-transform: rotate(210deg);
                                    transform: rotate(210deg);
                                    -webkit-animation-delay: -0.333333333333333s;
                                    animation-delay: -0.333333333333333s;
                                }

                                .lds-spinner div:nth-child(9) {
                                    -webkit-transform: rotate(240deg);
                                    transform: rotate(240deg);
                                    -webkit-animation-delay: -0.25s;
                                    animation-delay: -0.25s;
                                }

                                .lds-spinner div:nth-child(10) {
                                    -webkit-transform: rotate(270deg);
                                    transform: rotate(270deg);
                                    -webkit-animation-delay: -0.166666666666667s;
                                    animation-delay: -0.166666666666667s;
                                }

                                .lds-spinner div:nth-child(11) {
                                    -webkit-transform: rotate(300deg);
                                    transform: rotate(300deg);
                                    -webkit-animation-delay: -0.083333333333333s;
                                    animation-delay: -0.083333333333333s;
                                }

                                .lds-spinner div:nth-child(12) {
                                    -webkit-transform: rotate(330deg);
                                    transform: rotate(330deg);
                                    -webkit-animation-delay: 0s;
                                    animation-delay: 0s;
                                }

                                .lds-spinner {
                                    width: 200px !important;
                                    height: 200px !important;
                                    -webkit-transform: translate(-100px, -100px) scale(1) translate(100px, 100px);
                                    transform: translate(-100px, -100px) scale(1) translate(100px, 100px);
                                }
                            </style>
                        </div>
                    </div>

                </div>

            </div>
        </div>

        <script>






            document.getElementById("pmidbox").style.border = "thin solid #000";
            document.getElementById("doibox").style.border = "thin solid #000";
            document.getElementById("htmlbox").style.border = "thin solid #000";
            document.getElementById("extractbox").style.border = "thin solid #000";
            function setsamplehtmlinput() {
            toastr.options = {
                "closeButton": true,
                "timeOut": "2000",

            }
                toastr.success('Sample input applied.', 'SUCCESS');
                document.getElementById("htmldata").value = "&lt;ref id=&quot;B5&quot;&gt; &lt;label&gt;5&lt;/label&gt; &lt;element-citation publication-type=&quot;journal&quot; publication-format=&quot;print&quot;&gt; &lt;person-group person-group-type=&quot;author&quot;&gt; &lt;name&gt; &lt;surname&gt;Kaplan&lt;/surname&gt; &lt;given-names&gt;SH&lt;/given-names&gt; &lt;/name&gt; &lt;name&gt; &lt;surname&gt;Greenfield&lt;/surname&gt; &lt;given-names&gt;S&lt;/given-names&gt; &lt;/name&gt; &lt;name&gt; &lt;surname&gt;Ware&lt;/surname&gt; &lt;given-names&gt;JE&lt;/given-names&gt; &lt;/name&gt; &lt;/person-group&gt; &lt;article-title&gt;Assessing the effects of physician-patient interactions on the outcome of chronic disease&lt;/article-title&gt; &lt;source&gt;Med Care&lt;/source&gt; &lt;year iso-8601-date=&quot;1989&quot;&gt;1989&lt;/year&gt; &lt;volume&gt;27&lt;/volume&gt; &lt;supplement&gt;suppl 3&lt;/supplement&gt; &lt;fpage&gt;110&lt;/fpage&gt; &lt;lpage&gt;125&lt;/lpage&gt; &lt;/element-citation&gt; &lt;/ref&gt;"   }
            function setsamplerefinput() {
                toastr.options = {
                    "closeButton": true,
                    "timeOut": "2000",

                }
                toastr.success('Sample input applied.', 'SUCCESS');
                document.getElementById("refdata").value = "Frank, H. S. 1970. The Structure of Ordinary Water: New data and interpretations are yielding new insights into this fascinating substance. Science, 169(3946): 635641.%0DFrank, H. S. 1970. The Structure of Ordinary Water: New data and interpretations are yielding new insights into this fascinating substance. Science, 169(3946): 635641.";
            }
            function openPmidBox() {
                document.getElementById("htmldataFile").style.display = "none";
                document.getElementById('pmidbox').style.display = "block";
                document.getElementById('doibox').style.display = "none";
                document.getElementById('htmlbox').style.display = "none";
                document.getElementById('extractbox').style.display = "none";
                document.getElementById('referencebox').style.display = "none";
            }
            function openDoiBox() {
                document.getElementById("htmldataFile").style.display = "none";
                document.getElementById("htmldataFiletext").style.display = "none";
                document.getElementById('pmidbox').style.display = "none";
                document.getElementById('doibox').style.display = "block";
                document.getElementById('htmlbox').style.display = "none";
                document.getElementById('extractbox').style.display = "none";
                document.getElementById('referencebox').style.display = "none";
            }
            function openHtmlBox() {
                if (document.getElementById("htmldataFile"))
                    document.getElementById("htmldataFile").style.display = "none";
                document.getElementById("htmldataFiletext").style.display = "none";
                document.getElementById('pmidbox').style.display = "none";
                document.getElementById('doibox').style.display = "none";
                document.getElementById('htmlbox').style.display = "block";
                document.getElementById('extractbox').style.display = "none";
                document.getElementById('referencebox').style.display = "none";
                document.getElementById('pmidbox2').style.display = "none";
            }
            function openTBox() {
                if (document.getElementById("htmldataFile"))
                    document.getElementById("htmldataFile").style.display = "none";

                document.getElementById("htmldataFiletext").style.display = "none";
                document.getElementById('pmidbox').style.display = "none";
                document.getElementById('doibox').style.display = "none";
                document.getElementById('htmlbox').style.display = "none";
                document.getElementById('extractbox').style.display = "none";
                document.getElementById('referencebox').style.display = "block";
                document.getElementById('pmidbox2').style.display = "block";
                document.getElementById('referenceBoxInputFile').style.display = "block";


            }
            function openEBox() {
                if (document.getElementById("htmldataFile"))
                    document.getElementById("htmldataFile").style.display = "none";
                document.getElementById('pmidbox').style.display = "none";
                document.getElementById('doibox').style.display = "none";
                document.getElementById('htmlbox').style.display = "none";
                document.getElementById('extractbox').style.display = "block";
                document.getElementById('referencebox').style.display = "none";
            }
            document.getElementById('htmlbox').style.display = "block";
            document.getElementById('dataatab').style.display = "none";
            document.getElementById('dataatabExtract').style.display = "none";
            var table = $('#user_data').DataTable({
                "aaSorting": [[0, "desc"]],

                "dom": 'Bfrtip',

                "bProcessing": true,
                "scrollX": true,
                "ordering": false,
                "font-size": "10px",
                "autoWidth": false,
                "columnDefs": [
                    { "width": "310px", "targets": 0 },
                    { "width": "320px", "targets": 1 },
                    { "width": "320px", "targets": 2 },
                    { "width": "320px", "targets": 3 },
                    { "width": "320px", "targets": 4 },
                    { "width": "320px", "targets": 5 },
                    { "width": "320px", "targets": 6 }
                ]

            });
            var table2 = $('#user_data2').DataTable({
                "aaSorting": [[0, "desc"]],

                "dom": 'Bfrtip',
                "ordering": false,
                "bProcessing": true,
                "scrollX": true,
                "font-size": "10px"

            });
            function GenerateOutput(type, htmlmultipledata) {
                document.getElementById("json").innerHTML = "";
                document.getElementById("json3").innerHTML = "";
                document.getElementById("json5").innerHTML = "";
                document.getElementById("json4").innerHTML = "";
                document.getElementById("finalOutputDatas").innerHTML = "";

                document.getElementById("finalOutputDatas").innerHTML = " Processing... ";
                var journalTypeInfo = "article-journal";
                var style = document.getElementById("stylesName").innerHTML;
                var locale = document.getElementById("localeid").value;
                var pre = document.getElementById("preid").value;
                var post = document.getElementById("postid").value;
                var data;
                var biblioinputstring;
                var endpoint;
                document.getElementById('dataatab').style.display = "none";
                document.getElementById('dataatabExtract').style.display = "none";
                document.getElementById('dataatabpmidanddoi').style.display = "none";




                //var apiUrl =document.getElementById("generatedapi").value ;

                oopen();

                if (type == 'extract') {
                    document.getElementById('dataatab').style.display = "none";
                    document.getElementById('dataatabExtract').style.display = "none";
                    document.getElementById('dataatabpmidanddoi').style.display = "none";
                    var final = document.getElementById("generatedapi").value;

                    var final = document.getElementById("generatedapi").value;
                    //$('#myModal').modal('toggle');
                    table = $('#example').DataTable({
                        "ajax": {
                            "url": final,
                            "type": "POST",
                            'data': {
                                "style": style,
                                "locale": locale,
                                "pre": pre,
                                "post": post,
                                "data": data,
                                "type": type

                            },
                            "dataSrc": function (json) {

                                alert(JSON.stringify(json.status.message));
                                for (var i = 0; i < json.status.message.length; i++) {
                                    var x = json.status.message[i].value;

                                    json.status.message[i] = x;
                                }

                                alert(JSON.stringify(json.status.message));

                                return json.status.message;
                            }
                        },
                        "dom": 'Bfrtip',
                        "ordering": false,
                        "buttons": [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        "columns": [
                            {
                                "className": 'details-control',
                                "orderable": false,
                                "data": null,
                                "defaultContent": ''
                            },
                            { "data": "InputJSON" },
                            { "data": "BibliographyString" },
                            { "data": "Citation" },

                        ],
                        "columnDefs": [
                            { "width": "30px", "targets": 0 },
                            { "width": "60%", "targets": 1 },
                            { "width": "60%", "targets": 2 },
                            { "width": "60%", "targets": 3 },


                        ],
                        "order": [[1, 'asc']]
                    });
                } else if (type == 'html') {
                    if (style === "\n\n") {

                        alert("Please select the style");
                        toastr.clear()
                    } else {

                        document.getElementById('dataatab').style.display = "none";
                        document.getElementById('dataatabExtract').style.display = "none";
                        document.getElementById('dataatabpmidanddoi').style.display = "none";
                        toastr.options = {
                            "closeButton": false,
                            "timeOut": "500000",
                            "extendedTimeOut": "100000"
                        }
                        toastr.success('Processing, please wait..');
                        var dataval = document.getElementById("htmldata").value;
                        $.ajax({
                            url: '/api/mastermodule2',
                            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                            type: "POST",
                            data: { "data": dataval, "style": style, "type": "html", "locale": "locales-en-US.xml", "rateLimit": 20, "skipTrackChanges": 'true' },
                            success: function (val) {

                                console.log(JSON.stringify(val));
                                eextr = val;
                                toastr.clear();
                                document.getElementById("finalOutputDatas").innerHTML = "<div style=\"text-align:center\"> <font style\"text-align:center\" size=\"5px\" color=\"red\">     Validated and Formated</font></div> <br><br>";
                                if (eextr && eextr.message && eextr.message.Output && eextr.message.Output["ValidatedAndFormatted"].length > 0) {
                                    for (var i = 0; i < eextr.message.Output["ValidatedAndFormatted"].length; i++) {
                                        var xD = eextr.message.Output["ValidatedAndFormatted"][i];
                                        Object.keys(xD).map(function (s) {
                                            document.getElementById("finalOutputDatas").innerHTML += xD[s].BibliographyString;
                                        });
                                    }
                                } else {
                                    document.getElementById("finalOutputDatas").innerHTML += "<br> No reference set belong to validated and formatted section <br><br>";

                                }
                                document.getElementById("finalOutputDatas").innerHTML += "<br><div style=\"text-align:center\"> <font style\"text-align:center\" size=\"5px\" color=\"red\">  Non-Validated but Formated</font></div> <br><br>";

                                if (eextr && eextr.message && eextr.message.Output && eextr.message.Output["NonValidatedbutFormatted"].length > 0) {
                                    for (var i = 0; i < eextr.message.Output["NonValidatedbutFormatted"].length; i++) {
                                        var xD = eextr.message.Output["NonValidatedbutFormatted"][i];
                                        Object.keys(xD).map(function (s) {
                                            document.getElementById("finalOutputDatas").innerHTML += xD[s].BibliographyString;
                                        });
                                    }
                                } else {
                                    document.getElementById("finalOutputDatas").innerHTML += "<br> No reference set belong to Non validated but formatted section <br><br>";

                                }
                                document.getElementById("finalOutputDatas").innerHTML += "<br><div style=\"text-align:center\"> <font style\"text-align:center\" size=\"5px\" color=\"red\">  Failed Input</font></div> <br><br>";

                                if (eextr && eextr.message && eextr.message.FailedInputs.length > 0) {
                                    for (var i = 0; i < eextr.message.FailedInputs.length; i++) {
                                        var xD = eextr.message.FailedInputs[i];
                                        Object.keys(xD).map(function (s) {
                                            document.getElementById("finalOutputDatas").innerHTML += "<br><br>Reference  " + s + " failed. Reason : " + xD[s];
                                        });
                                    }
                                } else {
                                    document.getElementById("finalOutputDatas").innerHTML += "<br> No reference set belong to Failed Input section <br><br>";

                                }


                                toastr.success('Succesfully rendered the output.', 'SUCCESS', { timeOut: 3000 })
                            },
                            error: function (val) {
                                toastr.clear()
                                toastr.options = {};
                                document.getElementById("finalOutputDatas").innerHTML = "";
                                toastr.error('Failed to generate output. Something has gone wrong. Kindly check your net connection.', 'FAILED', { timeOut: 5000 })
                            }
                        });

                        table = $('#example').DataTable({
                            "ajax": final,
                            "dom": 'Bfrtip',
                            "ordering": false,
                            "buttons": [
                                'copy', 'csv', 'excel', 'pdf', 'print'
                            ],
                            "columns": [
                                {
                                    "className": 'details-control',
                                    "orderable": false,
                                    "data": null,
                                    "defaultContent": ''
                                },
                                { "data": "Input" },
                                { "data": "BibliographyStringUnstyled" },
                                { "data": "Citation" },

                            ],
                            "columnDefs": [
                                { "width": "30px", "targets": 0 },
                                { "width": "60%", "targets": 1 },
                                { "width": "60%", "targets": 2 },
                                { "width": "60%", "targets": 3 },


                            ],
                            "order": [[1, 'asc']]
                        });

                        $("#example tbody").unbind("click");
                        // Add event listener for opening and closing details
                        $('#example tbody').on('click', 'td.details-control', function () {

                            var tr = $(this).closest('tr');
                            var row = table.row(tr);

                            if (row.child.isShown()) {
                                // This row is already open - close it
                                row.child.hide();
                                tr.removeClass('shown');
                            }
                            else {
                                // Open this row
                                row.child(format(row.data())).show();
                                tr.addClass('shown');
                            }
                        });
                    }

                }
                else if (type == 'pmid' || type == 'doi') {


                    document.getElementById('dataatab').style.display = "none";
                    document.getElementById('dataatabExtract').style.display = "none";
                    document.getElementById('dataatabpmidanddoi').style.display = "none";


                    /* Formatting function for row details - modify as you need */
                    function format(d) {
                        var Pubmedarticlelink = "No Pubmed article exist";
                        var CrossrefArticleLink = "No Crossref article exist";
                        var pubmedjson = "Not found in pubmed";
                        var crossrefjson = "Skipped, since we found in pubmed";
                        var truecaser = "Slicing from the string error at html front end.";
                        var mergedJSON = "No merged JSON done";
                        if (d && d.MatchedJson && JSON.parse(d.MatchedJson)["Item-1"] && JSON.parse(d.MatchedJson)["Item-1"].title) {
                            var tempfinal = d.finalbiblio.toLowerCase();

                            var tempinput = JSON.parse(d.MatchedJson)["Item-1"].title.toLowerCase();
                            if (tempinput[tempinput.length - 1].match(/^[a-zA-Z0-9!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]*$/)) {
                                tempinput = tempinput.slice(0, -1);
                            }

                            var i1 = tempfinal.indexOf(tempinput);
                            if (tempfinal)

                                var ss = tempfinal.slice(i1, tempfinal.length);

                            var i2 = ss.indexOf("</span>");



                            truecaser = d.finalbiblio.slice(i1, (i2 + i1));

                        }

                        var inputsource;
                        if (d && d.InputConvertedJson && JSON.parse(d.InputConvertedJson) && JSON.parse(d.InputConvertedJson).PMID) {
                            inputsource = "Pubmed";
                            pubmedjson = d.MatchedJson;
                            mergedJSON = JSON.stringify(JSON.parse(d.MatchedJson)["Item-1"].author);


                        }
                        else if (d && d.InputConvertedJson && JSON.parse(d.InputConvertedJson) && JSON.parse(d.InputConvertedJson).DOI) {
                            inputsource = "Crossref";
                            crossrefjson = d.MatchedJson;
                            mergedJSON = JSON.parse(d.MatchedJson)["Item-1"];

                        }
                        else {
                            pubmedjson = "Not found in pubmed";
                            crossrefjson = "Not found in crossref"

                        }

                        if (d && d.MatchedJson && JSON.parse(d.MatchedJson)["Item-1"] && JSON.parse(d.MatchedJson)["Item-1"].DOI) {

                            CrossrefArticleLink = 'https://doi.org/' + JSON.parse(d.MatchedJson)["Item-1"].DOI;
                        }
                        if (d && d.MatchedJson && JSON.parse(d.MatchedJson)["Item-1"] && JSON.parse(d.MatchedJson)["Item-1"].PMID) {
                            Pubmedarticlelink = 'https://www.ncbi.nlm.nih.gov/pubmed/' + JSON.parse(d.MatchedJson)["Item-1"].PMID;

                        }

                        // `d` is the original data object for the row
                        return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">' +
                            '<tr>' +
                            '<td>Input:</td>' +
                            '<td>' + d.Input + '</td>' +
                            '</tr>' +
                            '<tr>' +

                            '<td>Input data converted to json:</td>' +
                            '<td>' + JSON.stringify(d.InputConvertedJson1) + '</td>' +

                            '</tr>' +
                            '<td>Output from parseReference:</td>' +
                            '<td>' + d.parseref + ' </td>' +
                            '</tr>' +
                            '<tr>' +
                            '<tr>' +
                            '<tr>' +
                            '<td>PUBMED JSON:</td>' +
                            '<td>' + pubmedjson + '</td>' +
                            '</tr>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>CROSSREF JSON:</td>' +
                            '<td>' + crossrefjson + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Merged JSON:</td>' +
                            '<td>' + mergedJSON + '</td>' +
                            '</tr>' +

                            '<td>Output from TrueCaser:</td>' +
                            '<td>' + truecaser + '</td>' +

                            '</tr>' +
                            '</tr>' +

                            '<td>Changed JSON:</td>' +
                            '<td>' + d.ChangedJSON + '</td>' +

                            '</tr>' +
                            '<tr>' +
                            '<td>Input to CiteProc system:</td>' +
                            '<td>' + d.MatchedJson + '</td>' +
                            '</tr>' +

                            '<tr>' +
                            '<td>Bibliography String from CiteProc system:</td>' +
                            '<td>' + d.BibliographyStringUnstyled + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Citation String from CiteProc system:</td>' +
                            '<td>' + d.Citation + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Final Generated Bibliography string:</td>' +
                            '<td>' + d.finalbiblio + '</td>' +
                            '</tr>' +

                            '<tr>' +
                            '<td>Crossref  link of the article:</td>' +
                            '<td>' + CrossrefArticleLink + '</td>' +
                            '</tr>' +

                            '<tr>' +
                            '<td>Pubmed  link of the article:</td>' +
                            '<td>' + Pubmedarticlelink + '</td>' +
                            '</tr>' +

                            '</table>';
                    }
                    function format(d) {
                        var Pubmedarticlelink = "No Pubmed article exist";
                        var CrossrefArticleLink = "No Crossref article exist";
                        var pubmedjson = "Not found in pubmed";
                        var crossrefjson = "Skipped, since we found in pubmed";
                        var truecaser = "Slicing from the string error at html front end.";
                        var mergedJSON = "No merged JSON done";
                        if (d && d.MatchedJson && JSON.parse(d.MatchedJson)["Item-1"] && JSON.parse(d.MatchedJson)["Item-1"].title) {
                            var tempfinal = d.finalbiblio.toLowerCase();

                            var tempinput = JSON.parse(d.MatchedJson)["Item-1"].title.toLowerCase();
                            if (tempinput[tempinput.length - 1].match(/^[a-zA-Z0-9!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]*$/)) {
                                tempinput = tempinput.slice(0, -1);
                            }

                            var i1 = tempfinal.indexOf(tempinput);
                            if (tempfinal)

                                var ss = tempfinal.slice(i1, tempfinal.length);

                            var i2 = ss.indexOf("</span>");



                            truecaser = d.finalbiblio.slice(i1, (i2 + i1));

                        }

                        var inputsource;
                        if (d && d.InputConvertedJson && JSON.parse(d.InputConvertedJson) && JSON.parse(d.InputConvertedJson).PMID) {
                            inputsource = "Pubmed";
                            pubmedjson = d.MatchedJson;
                            mergedJSON = JSON.stringify(JSON.parse(d.MatchedJson)["Item-1"].author);


                        }
                        else if (d && d.InputConvertedJson && JSON.parse(d.InputConvertedJson) && JSON.parse(d.InputConvertedJson).DOI) {
                            inputsource = "Crossref";
                            crossrefjson = d.MatchedJson;
                            mergedJSON = JSON.parse(d.MatchedJson)["Item-1"];

                        }
                        else {
                            pubmedjson = "Not found in pubmed";
                            crossrefjson = "Not found in crossref"

                        }

                        if (d && d.MatchedJson && JSON.parse(d.MatchedJson)["Item-1"] && JSON.parse(d.MatchedJson)["Item-1"].DOI) {

                            CrossrefArticleLink = 'https://doi.org/' + JSON.parse(d.MatchedJson)["Item-1"].DOI;
                        }
                        if (d && d.MatchedJson && JSON.parse(d.MatchedJson)["Item-1"] && JSON.parse(d.MatchedJson)["Item-1"].PMID) {
                            Pubmedarticlelink = 'https://www.ncbi.nlm.nih.gov/pubmed/' + JSON.parse(d.MatchedJson)["Item-1"].PMID;

                        }

                        // `d` is the original data object for the row
                        return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">' +
                            '<tr>' +
                            '<td>Input:</td>' +
                            '<td>' + d.Input + '</td>' +
                            '</tr>' +
                            '<tr>' +

                            '<td>Input data converted to json:</td>' +
                            '<td>' + JSON.stringify(d.InputConvertedJson) + '</td>' +

                            '</tr>' +
                            '<td>Output from parseReference:</td>' +
                            '<td>' + d.parseref + ' </td>' +
                            '</tr>' +
                            '<tr>' +
                            '<tr>' +
                            '<tr>' +
                            '<td>PUBMED JSON:</td>' +
                            '<td>' + pubmedjson + '</td>' +
                            '</tr>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>CROSSREF JSON:</td>' +
                            '<td>' + crossrefjson + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Merged JSON:</td>' +
                            '<td>' + mergedJSON + '</td>' +
                            '</tr>' +

                            '<td>Output from TrueCaser:</td>' +
                            '<td>' + truecaser + '</td>' +

                            '</tr>' +
                            '</tr>' +

                            '<td>Changed JSON:</td>' +
                            '<td>' + d.ChangedJSON + '</td>' +

                            '</tr>' +
                            '<tr>' +
                            '<td>Input to CiteProc system:</td>' +
                            '<td>' + d.MatchedJson + '</td>' +
                            '</tr>' +

                            '<tr>' +
                            '<td>Bibliography String from CiteProc system:</td>' +
                            '<td>' + d.BibliographyStringUnstyled + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Citation String from CiteProc system:</td>' +
                            '<td>' + d.Citation + '</td>' +
                            '</tr>' +
                            '<tr>' +
                            '<td>Final Generated Bibliography string:</td>' +
                            '<td>' + d.finalbiblio + '</td>' +
                            '</tr>' +

                            '<tr>' +
                            '<td>Crossref  link of the article:</td>' +
                            '<td>' + CrossrefArticleLink + '</td>' +
                            '</tr>' +

                            '<tr>' +
                            '<td>Pubmed  link of the article:</td>' +
                            '<td>' + Pubmedarticlelink + '</td>' +
                            '</tr>' +

                            '</table>';
                    }
                    table.destroy();
                    var final = document.getElementById("generatedapi").value;
                    //alert(final);

                    table = $('#example').DataTable({

                        "ajax": {
                            "url": final,
                            "type": "POST",
                            'data': {
                                "style": style,
                                "locale": locale,
                                "pre": pre,
                                "post": post,
                                "data": data,
                                "type": type

                            },
                            "dataSrc": function (json) {


                                return json.status.message.data;





                            }
                        },

                        "dom": 'Bfrtip',
                        "ordering": false,
                        "buttons": [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        "columns": [
                            {
                                "className": 'details-control',
                                "orderable": false,
                                "data": null,
                                "defaultContent": ''
                            },
                            { "data": "Input" },
                            { "data": "BibliographyStringUnstyled" },
                            { "data": "Citation" },

                        ],
                        "columnDefs": [
                            { "width": "30px", "targets": 0 },
                            { "width": "60%", "targets": 1 },
                            { "width": "60%", "targets": 2 },
                            { "width": "60%", "targets": 3 },


                        ],
                        "order": [[1, 'asc']]
                    });
                    $("#example tbody").unbind("click");
                    // Add event listener for opening and closing details
                    $('#example tbody').on('click', 'td.details-control', function () {

                        var tr = $(this).closest('tr');
                        var row = table.row(tr);

                        if (row.child.isShown()) {
                            // This row is already open - close it
                            row.child.hide();
                            tr.removeClass('shown');
                        }
                        else {
                            // Open this row
                            row.child(format(row.data())).show();
                            tr.addClass('shown');
                        }
                    });



                }
                else if (type = "reference") {
                    
                    convertToBSJSON();

                }
                return false;
            }
            function convertToBSJSON() {
                

                    $.ajax({
                        url: '/api/jatsconverter',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        type: "POST",
                        data: { "text": document.getElementById("refdata").value },
                        success: function (val) {
                            toastr.clear()
                            toastr.options = {
                                "closeButton": false,
                                "timeOut": "12000"
                            }

                            toastr.success('Succesfully Tagged.', 'SUCCESS');
                            document.getElementById("json").innerHTML = JSON.stringify(val.data,undefined,2);
                            val.xml=val.xml.replace(/\>\s+\</g,'><');
                            document.getElementById("json5").innerHTML = JSON.stringify(val.xml);
                            document.getElementById("json5").innerHTML=document.getElementById("json5").innerHTML.replace(/\\n/g, "");
                          

                        },
                        error: function (val) {
                            document.getElementById("json2").innerHTML = "Failed. Data datasets were not tagged";
                            toastr.clear()
                            toastr.options = {};
                            toastr.error('Failed to generate output. Something has gone wrong. Kindly check your net connection.', 'FAILED', { timeOut: 5000 })
                        }
                    });
                

            }
            function ValidateJSON(dataval) {

                if (dataval == "") {
                    alert("you have supplied empty data input"); toastr.clear()
                } else {
                    $.ajax({
                        url: '/api/ValidateUsingFetchPmidandResolvemultiplepmid',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        type: "POST",
                        data: { "data": dataval, "style": document.getElementById("stylesName").innerHTML, "type": "reference", "locale": "locales-en-US.xml", "rateLimit": 20, "skipTrackChanges": 'true' },
                        success: function (valueofdata) {
                            toastr.clear()
                            toastr.success('Succesfully Validated.', 'SUCCESS', { timeOut: 12000 });
                            document.getElementById("json3").innerHTML = JSON.stringify(valueofdata, undefined, 2);
                            console.log("hey");
                            console.log(valueofdata);
                            var valofData = {};
                            var succesfullyValidated = 0;
                            var FailedtoValidate = 0;
                            var Failed = 0;
                            for (si = 0; si < valueofdata.length; si++) {
                                if (valueofdata[si].state == "fulfilled") {
                                    var message = valueofdata[si].value.message;
                                    if (message.SuccesfullyValidatedAndResolved)
                                        succesfullyValidated += message.SuccesfullyValidatedAndResolved.length;
                                    if (message.FailedInputs)
                                        Failed += message.FailedInputs.length;
                                    if (message.YetToBeResolved)
                                        FailedtoValidate += message.YetToBeResolved.length;


                                }
                            }
                            document.getElementById("json4").innerHTML = JSON.stringify({ "Validated": succesfullyValidated, "NotValidated": FailedtoValidate, "Failed": Failed }, undefined, 2)
                            //  GenerateOutputref(valueofdata, document.getElementById("stylesName").innerHTML,20)
                        },
                        error: function (val) {
                            toastr.clear()
                            toastr.options = {};
                            document.getElementById("finalOutputDatas").innerHTML = "";

                            toastr.error('Failed to generate output. Something has gone wrong. Kindly check your net connection.', 'FAILED', { timeOut: 5000 })
                        }
                    });
                }

            }

            function downloadDatas(type, name) {
                toastr.success('Processing, Please wait..', { timeOut: 100000 });

                $.ajax({
                    url: '/api/anystyle',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    type: "POST",
                    data: { "information": type, "type": "train", "locale": "locales-en-US.xml", "rateLimit": 20, "skipTrackChanges": 'true' },
                    success: function (valueofdata) {

                        toastr.clear()
                        toastr.success('Succesfully downloaded.', 'SUCCESS', { timeOut: 12000 });
                        var elHtml = new XMLSerializer().serializeToString(valueofdata.documentElement);
                        var link = document.createElement('a');
                        mimeType = 'text/plain';

                        link.setAttribute('download', name);
                        link.setAttribute('href', 'data:' + mimeType + ';charset=utf-8,' + encodeURIComponent(elHtml));
                        link.click();
                        return false;
                    },
                    error: function (val) {

                        toastr.clear()
                        toastr.options = {};

                        toastr.error('Failed to generate output. Something has gone wrong. Kindly check your net connection.', 'FAILED', { timeOut: 5000 })
                    }
                });


            }
            function GenerateOutputref(valueofdata, style, rateLimit) {

                style = style.trim();
                if (style == "\n\n" || style == "" || document.getElementById("stylesName").innerHTML.trim() == "") {
                    toastr.clear();
                    alert("Please select the style");

                } else if (valueofdata == "") {
                    alert("you have supplied empty reference"); toastr.clear();
                } else if (rateLimit == "") {
                    alert("Please add the batch rate limit."); toastr.clear();
                } else {
                    for (var i = 0; i < valueofdata.length; i++) {
                        var k = valueofdata[i];
                        if (k.state == "fulfilled") {
                            if (k && k.value && k.value && k.value.message && k.value.message.InputSupplied) {
                                k.value.message.InputSupplied.style = document.getElementById("stylesName").innerHTML;
                            }
                        }

                    }

                    $.ajax({
                        url: '/api/generatebibliography',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        type: "POST",
                        data: { "data": valueofdata, "style": style, "type": "reference", "locale": "locales-en-US.xml", "rateLimit": rateLimit, "skipTrackChanges": 'true' },
                        success: function (val) {


                            eextr = val;
                            console.log(val);
                            toastr.clear();
                            document.getElementById("finalOutputDatas").innerHTML = "<div style=\"text-align:center\"> <font style\"text-align:center\" size=\"5px\" color=\"red\">     Validated and Formated</font></div> <br><br>";
                            if (eextr && eextr.message && eextr.message.Output && eextr.message.Output["ValidatedAndFormatted"].length > 0) {
                                for (var i = 0; i < eextr.message.Output["ValidatedAndFormatted"].length; i++) {
                                    var xD = eextr.message.Output["ValidatedAndFormatted"][i];
                                    Object.keys(xD).map(function (s) {
                                        for (var i = 0; i < xD[s].BibliographyString.length; i++) {
                                            document.getElementById("finalOutputDatas").innerHTML += xD[s].BibliographyString[i];
                                        }
                                    });
                                }
                            } else {
                                document.getElementById("finalOutputDatas").innerHTML += "<br> No reference set belong to validated and formatted section <br><br>";

                            }
                            document.getElementById("finalOutputDatas").innerHTML += "<br><div style=\"text-align:center\"> <font style\"text-align:center\" size=\"5px\" color=\"red\">  Non-Validated but Formated</font></div> <br><br>";

                            if (eextr && eextr.message && eextr.message.Output && eextr.message.Output["NonValidatedbutFormatted"].length > 0) {
                                for (var i = 0; i < eextr.message.Output["NonValidatedbutFormatted"].length; i++) {
                                    var xD = eextr.message.Output["NonValidatedbutFormatted"][i];
                                    Object.keys(xD).map(function (s) {
                                        for (var i = 0; i < xD[s].BibliographyString.length; i++) {
                                            document.getElementById("finalOutputDatas").innerHTML += xD[s].BibliographyString[i];
                                        }
                                    });
                                }
                            } else {
                                document.getElementById("finalOutputDatas").innerHTML += "<br> No reference set belong to Non validated but formatted section <br><br>";

                            }
                            document.getElementById("finalOutputDatas").innerHTML += "<br><div style=\"text-align:center\"> <font style\"text-align:center\" size=\"5px\" color=\"red\">  Failed Input</font></div> <br><br>";
                            console.log(eextr);
                            if (eextr && eextr.message && eextr.message.FailedInputs.length > 0) {

                                for (var i = 0; i < eextr.message.FailedInputs.length; i++) {
                                    var xD = eextr.message.FailedInputs[i];
                                    Object.keys(xD).map(function (s) {
                                        document.getElementById("finalOutputDatas").innerHTML += "<br><br>Reference  " + s + " failed. Reason : " + xD[s];

                                    });
                                }
                            } else {
                                document.getElementById("finalOutputDatas").innerHTML += "<br> No reference set belong to Failed Input section <br><br>";

                            }


                            toastr.success('Succesfully rendered the output.', 'SUCCESS', { timeOut: 3000 })
                        },
                        error: function (val) {
                            toastr.clear()
                            toastr.options = {};
                            document.getElementById("finalOutputDatas").innerHTML = "";
                            toastr.error('Failed to generate output. Something has gone wrong. Kindly check your net connection.', 'FAILED', { timeOut: 5000 })
                        }
                    });
                }
            }



            function oopen() {


            }
            oopen();
            var eextr = [];

            openTBox();

        </script>

</body>

</html>